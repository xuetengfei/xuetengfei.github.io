运营商是指那些提供宽带服务的 ISP，包括三大运营商中国电信、中国移动和中国联通。

运营商都是提供最基础的网络服务，网络运营商为了卖广告或者其他经济利益，有时候会直
接劫持用户的访问，目前，运营商比较常见的劫持方式有两种，分别是 DNS 劫持，HTTP 劫
持。

网络劫持最主要的就是运营商层面的劫持。可以说，我们每个人随时随地都在与它打交道。
而运营商劫持又主要分两种：

> DNS 劫持

这种劫持会把你重新定位到其它网站，我们所熟悉的钓鱼网站就是这个原理。但是因为它的
违法性，现在被严厉的监管起来，已经很少见。

> HTTP 劫持

基于 HTTP 的流量劫持，特别是对于 Web 前端，基本上就是因为 HTTP 属于明文协议，中
间链路上的任意设备，都可以篡改内容，导致流量劫持。

遇到 HTTP 协议的数据包，就看一下 Content-Type 是不是 text/html，如果发现传输的内
容是 html 网页，就在`<head>`标签中插入一个外部引用`<script>`，通过这个外部的 JS
脚本动态的生成一个`<iframe>`加载他们的广告。

![20220331-GKrNWc-640(2)](https://loremxuetengfei.oss-cn-beijing.aliyuncs.com/20220331-GKrNWc-640
(2).jpg)

> 为什么会这样？

HTTP 请求是在网络中是明文传输，而且必须经过运营商，于是运营商层面可以很轻松地修
改响应的 HTTP 内容。比如在返回的 HTML 里直接加一段 JS，JS 可以直接在客户端执行实
现任何想要的效果。

[内容安全策略( CSP ) - HTTP | MDN](https://developer.mozilla.org/zh-CN/docs/Web/HTTP/CSP)
[浅谈流量劫持与防治](https://zhuanlan.zhihu.com/p/40682772)
[CSP 防运营商劫持 - 掘金](https://juejin.cn/post/6844903716802265096)
